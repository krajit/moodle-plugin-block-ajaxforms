define("block_revisionmanager/formhandler",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){return{init:function(params){const levelColors={"Not Started":"#f8d7da",Fresh:"#fce5cd",Learning:"#fff3cd",Expert:"#d1ecf1",Done:"#d4edda"};function updateLevelColor(){const levelSelect=document.getElementById("learninglevel"),selectedLevel=null==levelSelect?void 0:levelSelect.value;selectedLevel&&levelColors[selectedLevel]?levelSelect.style.backgroundColor=levelColors[selectedLevel]:levelSelect&&(levelSelect.style.backgroundColor="white")}function updateProgressBar(){const revisionInput=document.getElementById("revisioncount"),targetInput=document.getElementById("targetcount"),progressBar=document.getElementById("progressBar"),revisioncount=parseInt((null==revisionInput?void 0:revisionInput.value)||0),targetcount=parseInt((null==targetInput?void 0:targetInput.value)||1),percent=Math.min(100,Math.round(revisioncount/targetcount*100));progressBar&&(progressBar.style.width=percent+"%",progressBar.textContent=percent+"%")}function saveData(){const date=$("#nextReview").val(),learninglevel=$("#learninglevel").val(),revisioncount=$("#revisioncount").val(),targetcount=$("#targetcount").val(),pageurl=window.location.pathname+window.location.search;date?Ajax.call([{methodname:"block_revisionmanager_save_entry",args:{nextreview:date,pageurl:pageurl,courseid:params.courseid,pagetitle:params.pagetitle,learninglevel:learninglevel,revisioncount:revisioncount,targetcount:targetcount},done:function(response){console.log("Saved:",response.status)},fail:Notification.exception}]):window.console.log("date cleared. TODO: Update when to delete page row from the table")}$("#nextReview").on("input change",saveData),$("#learninglevel").on("input change",(function(){updateLevelColor(),saveData()})),$("#revisioncount").on("input change",(function(){updateProgressBar(),saveData()})),$("#targetcount").on("input change",(function(){updateProgressBar(),saveData()})),updateLevelColor(),updateProgressBar(),function(){const pageurl=window.location.pathname+window.location.search;Ajax.call([{methodname:"block_revisionmanager_get_entry",args:{pageurl:pageurl,courseid:params.courseid},done:function(data){data.nextreview&&$("#nextReview").val(data.nextreview),data.learninglevel&&($("#learninglevel").val(data.learninglevel),updateLevelColor()),data.revisioncount&&$("#revisioncount").val(data.revisioncount),data.targetcount&&$("#targetcount").val(data.targetcount),updateProgressBar()},fail:Notification.exception}])}()}}}));

//# sourceMappingURL=formhandler.min.js.map