{"version":3,"file":"boooktocmarker.min.js","sources":["../src/boooktocmarker.js"],"sourcesContent":["define(['jquery', 'core/ajax'], function($, Ajax) {\n    return {\n        init: function(params) {\n            Ajax.call([{\n                methodname: 'block_revisionmanager_get_read_urls',\n                args: { courseid: params.courseid },\n                done: function(result) {\n                    // Build a map: fullpath → ratingvalues[]\n                    const urlRatingsMap = {};\n                    result.entries.forEach(entry => {\n                        const cleanUrl = entry.pageurl.replace(/^\\/+/, ''); // remove leading slashes\n                        urlRatingsMap[cleanUrl] = entry.ratingvalues;\n                    });\n\n                    console.log('URL to ratings map:', urlRatingsMap);\n\n                    $('div.book_toc a').each(function() {\n                        const href = $(this).attr('href'); // e.g., \"view.php?id=28&chapterid=130\"\n                        const fullpath = 'mod/book/' + href;\n\n                        if (urlRatingsMap[fullpath]) {\n                            const ratings = urlRatingsMap[fullpath].join('');\n                            console.log(`Matched ${fullpath} → ${ratings}`);\n                            $(this).prepend(`${ratings} `);\n                        }\n                    });\n                },\n                fail: function(err) {\n                    console.error(\"Could not fetch read URLs\", err);\n                }\n            }]);\n\n        }\n    };\n});\n"],"names":["define","$","Ajax","init","params","call","methodname","args","courseid","done","result","urlRatingsMap","entries","forEach","entry","cleanUrl","pageurl","replace","ratingvalues","console","log","each","fullpath","this","attr","ratings","join","prepend","fail","err","error"],"mappings":"AAAAA,8CAAO,CAAC,SAAU,cAAc,SAASC,EAAGC,YACjC,CACHC,KAAM,SAASC,QACXF,KAAKG,KAAK,CAAC,CACPC,WAAY,sCACZC,KAAM,CAAEC,SAAUJ,OAAOI,UACzBC,KAAM,SAASC,cAELC,cAAgB,GACtBD,OAAOE,QAAQC,SAAQC,cACbC,SAAWD,MAAME,QAAQC,QAAQ,OAAQ,IAC/CN,cAAcI,UAAYD,MAAMI,gBAGpCC,QAAQC,IAAI,sBAAuBT,eAEnCV,EAAE,kBAAkBoB,MAAK,iBAEfC,SAAW,YADJrB,EAAEsB,MAAMC,KAAK,WAGtBb,cAAcW,UAAW,OACnBG,QAAUd,cAAcW,UAAUI,KAAK,IAC7CP,QAAQC,sBAAeE,uBAAcG,UACrCxB,EAAEsB,MAAMI,kBAAWF,mBAI/BG,KAAM,SAASC,KACXV,QAAQW,MAAM,4BAA6BD"}